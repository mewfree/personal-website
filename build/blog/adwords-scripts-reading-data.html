<!doctype html><html lang="en"><head><title>Google Ads Scripts: Reading Data - Damien Gonot</title><link href="/output.css" rel="stylesheet"><link href="/highlight.css" rel="stylesheet"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Personal Website of Damien Gonot"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body><header class="bg-indigo-600 text-center text-white p-8"><div class="text-4xl font-bold mb-4">Damien Gonot</div><div class="text-xl flex space-x-8 justify-center"><a href="/" class="hover:underline">Home</a> <a href="/blog" class="hover:underline">Blog</a> <a href="/about" class="hover:underline">About</a></div></header><div class="prose prose-indigo max-w-3xl mx-auto p-8"><h1 class="text-center">Google Ads Scripts: Reading Data</h1><div class="text-center">written on 2018-03-22</div><h2 id="how-to-read-data-from-google-ads-scripts">How to read data from Google Ads scripts?</h2><p>In the <a href="/blog/brief-introduction-to-adwords-scripts">Brief Introduction to Google Ads Scripts</a>, we saw how to create our first Google Ads script. Now we’ll try to do something useful with it. One of the first steps is to learn how to read campaigns data from Google Ads scripts.</p><h3 id="getting-a-list-of-running-campaigns">Getting a list of running campaigns</h3><p>To get a list of campaigns, we’ll use <a href="https://developers.google.com/adwords/scripts/docs/reference/adwordsapp/adwordsapp_campaignselector"><code>AdsApp.CampaignSelector</code></a>. As a very basic first example, we’ll try to fetch all of our <em>running</em> campaigns.</p><p>First of all, to structure our code a bit, we’ll create a function outside of <code>main()</code>. We can call it <code>getAllActiveCampaigns()</code> and declare it that way: <code>function getAllActiveCampaigns() {}</code>. Remember that only what’s inside <code>main()</code> will run, so we’ll have to call <code>getAllActiveCampaigns()</code> inside it later but we’ll omit it for now.</p><p><code>AdsApp.campaigns().get()</code> is going to fetch <em>all</em> campaigns. If we want to be able to re-use it, we have to store it in a variable:</p><div class="sourceCode" id="cb1"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getAllActiveCampaigns</span>() {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> campaigns <span class="op">=</span> AdsApp<span class="op">.</span><span class="fu">campaigns</span>()<span class="op">.</span><span class="fu">get</span>()<span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><p>But remember that we only want <em>running</em> campaigns. We can use <code>.withCondition()</code> to introduce filtering:</p><div class="sourceCode" id="cb2"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getAllActiveCampaigns</span>() {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> campaigns <span class="op">=</span> AdsApp</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">campaigns</span>()</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">withCondition</span>(<span class="st">&#39;Status = ENABLED&#39;</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">get</span>()<span class="op">;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><p>Note the line indentation introduced for more readability. It is 100% optional but very recommended.</p><p>Other examples of conditions may be: <code>.withCondition('Impressions &gt; 1000')</code>, <code>.withCondition("Name CONTAINS 'Canada'")</code>… Those conditions are also chainable.</p><p>In order to help us, Google Ads is returning a few helpers alongside the list of campaigns we fetched. It can be really helpful to loop over the results. Here is an example with a <code>while() {}</code> loop, along with Google Ads scripts’ <code>.next()</code> and <code>.hasNext()</code> helpers:</p><div class="sourceCode" id="cb3"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getAllActiveCampaigns</span>() {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> campaigns <span class="op">=</span> AdsApp</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">campaigns</span>()</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">withCondition</span>(<span class="st">&#39;Status = ENABLED&#39;</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">get</span>()<span class="op">;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (campaigns<span class="op">.</span><span class="fu">hasNext</span>()) {</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> campaign <span class="op">=</span> campaigns<span class="op">.</span><span class="fu">next</span>()<span class="op">;</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><p>Now if you try to run this, it wouldn’t do anything, because the loop is basically empty. Let’s log the name of the campaign: <code>Logger.log(campaign.getName());</code>.</p><p>Let’s try to do a bit more. Campaign budget can be easily fetched with <code>.getBudget()</code> but it only returns an integer (for example, for a budget of $100, the response will be 100), so let’s try to get the currency code too. <code>AdsApp.currentAccount().getCurrencyCode()</code> should do!</p><p>Here is the final result:</p><div class="sourceCode" id="cb4"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getAllActiveCampaigns</span>() {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> campaigns <span class="op">=</span> AdsApp</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">campaigns</span>()</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">withCondition</span>(<span class="st">&#39;Status = ENABLED&#39;</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">get</span>()<span class="op">;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (campaigns<span class="op">.</span><span class="fu">hasNext</span>()) {</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> campaign <span class="op">=</span> campaigns<span class="op">.</span><span class="fu">next</span>()<span class="op">;</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    Logger<span class="op">.</span><span class="fu">log</span>(campaign<span class="op">.</span><span class="fu">getName</span>())<span class="op">;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    Logger<span class="op">.</span><span class="fu">log</span>(<span class="st">&#39;Daily Budget: &#39;</span> <span class="op">+</span> campaign<span class="op">.</span><span class="fu">getBudget</span>() <span class="op">+</span> AdsApp<span class="op">.</span><span class="fu">currentAccount</span>()<span class="op">.</span><span class="fu">getCurrencyCode</span>())<span class="op">;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">getAllActiveCampaigns</span>()<span class="op">;</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><p>In the Google Ads scripts interface, your <em>running</em> campaigns and with their respective budgets should appear: <img src="/images/final_result.png" alt="Final result"></p><p>(Obviously, your own results will differ from mine 😊).</p><h3 id="getting-a-list-of-ad-groups">Getting a list of ad groups</h3><p>From what we’ve just learnt with how to read campaigns above, getting a list of ad groups will be really easy. We only need to switch <code>AdsApp.campaigns()</code> with <code>AdsApp.adGroups()</code> as well as some variables’ names.</p><div class="sourceCode" id="cb5"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getAllAdGroups</span>() {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> adGroups <span class="op">=</span> AdsApp</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">adGroups</span>()</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">get</span>()<span class="op">;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (adGroups<span class="op">.</span><span class="fu">hasNext</span>()) {</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> adGroup <span class="op">=</span> adGroups<span class="op">.</span><span class="fu">next</span>()<span class="op">;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    Logger<span class="op">.</span><span class="fu">log</span>(adGroup<span class="op">.</span><span class="fu">getName</span>())<span class="op">;</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><p>As budgets are placed on a campaign level, you would get an error trying to run <code>adGroup.getBudget()</code> so I simply ommited it here. <img src="/images/ag_result.png" alt="Ad groups result"></p><h3 id="getting-a-list-of-ads-inside-an-ad-group">Getting a list of ads inside an ad group</h3><p>Same thing with ads, we can simply replace <code>AdsApp.adGroups()</code> by <code>AdsApp.ads()</code>. But let’s do things a bit differently this time. Let’s get the ads inside a specific ad group.</p><p>We can simply select an ad group by its name with <code>.withCondition()</code>. <code>if (adGroup.hasNext()) {}</code> condition is present in case our “search” didn’t result any ad group. After that, we can log the part 1 &amp; part 2 headlines (in the case of Expanded text ads).</p><div class="sourceCode" id="cb6"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">getAdsInAdGroup</span>() {</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> adGroup <span class="op">=</span> AdsApp</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">adGroups</span>()</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">withCondition</span>(<span class="st">&quot;Name = &#39;Ad Group #1&#39;&quot;</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">get</span>()<span class="op">;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (adGroup<span class="op">.</span><span class="fu">hasNext</span>()) {</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> ads <span class="op">=</span> adGroup<span class="op">.</span><span class="fu">next</span>()<span class="op">.</span><span class="fu">ads</span>()<span class="op">.</span><span class="fu">get</span>()<span class="op">;</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> (ads<span class="op">.</span><span class="fu">hasNext</span>()) {</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>      <span class="kw">var</span> ad <span class="op">=</span> ads<span class="op">.</span><span class="fu">next</span>()<span class="op">;</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>      Logger<span class="op">.</span><span class="fu">log</span>(ad<span class="op">.</span><span class="fu">getHeadlinePart1</span>())<span class="op">;</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>      Logger<span class="op">.</span><span class="fu">log</span>(ad<span class="op">.</span><span class="fu">getHeadlinePart2</span>())<span class="op">;</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><p><strong>You should now be comfortable reading campaigns, ad groups &amp; ads from Google Ads scripts!</strong></p></div><script src="/highlight.js"></script><script>hljs.highlightAll();</script></body></html>
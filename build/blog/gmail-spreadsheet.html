<!doctype html><html lang="en"><head><title>üß® Supercharge Your Spreadsheets With Free Emailing üìÆ - Damien Gonot</title><link href="/output.css" rel="stylesheet"><link href="/highlight.css" rel="stylesheet"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Introduction

Did you know it was possible to send free emails directly from Google
Spreadsheets?

Whether you‚Äôre a small business owner looking to send updates about your
product to your user base, a marketer looking for a free newsletter
solution or a startup looking to bootstrap your sales ema..."><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body><header class="bg-indigo-600 text-center text-white p-8"><div class="text-4xl font-bold mb-4">Damien Gonot</div><div class="text-xl flex space-x-8 justify-center"><a href="/" class="hover:underline">Home</a> <a href="/blog" class="hover:underline">Blog</a> <a href="/about" class="hover:underline">About</a></div></header><div class="prose prose-indigo max-w-3xl mx-auto p-8"><h1 class="text-center">üß® Supercharge Your Spreadsheets With Free Emailing üìÆ</h1><div class="text-center">written on 2020-05-20</div><h2 id="introduction">Introduction</h2><p>Did you know it was possible to send free emails directly from Google Spreadsheets?</p><p>Whether you‚Äôre a small business owner looking to send updates about your product to your user base, a marketer looking for a free newsletter solution or a startup looking to bootstrap your sales emails without an expensive CRM, this article is made for you.</p><h2 id="spreadsheet-setup">Spreadsheet Setup</h2><p><a href="https://docs.google.com/spreadsheets/d/1Jg9fIoUMBI75eDGbEJGevcU2HHH59hTlK-v0k_A8Al4/edit?usp=sharing">Here is a sample sheet I‚Äôll use as an example</a>.</p><figure><img src="/images/spreadsheet_sample.png" alt="Spreadsheet Sample"><figcaption aria-hidden="true">Spreadsheet Sample</figcaption></figure><p>Feel free to duplicate it by clicking on <strong>File &gt; Make a copy</strong>.</p><p>You can also create a new Google Spreadsheet (fastest way to is head to <a href="https://sheet.new">sheet.new</a>) if you want to start fresh.</p><p><strong>Columns A, B and C</strong> are pretty self-explanatory. You should replace the fictitious names &amp; emails with the real data you have about the people you want to send emails to.</p><p><strong>Column D</strong> is a template for our email title: <code>=CONCATENATE(INDEX(SPLIT(A2, " "), 1), ", have you heard about X?")</code>.</p><p><code>INDEX(SPLIT(A2, " "), 1)</code> means: ‚Äútake the value in <code>A2</code>, split it by space, and take the first element from that split‚Äù. This is because we have a single column for ‚Äúname‚Äù and it allows us to address the recipient by their first name only. If you have separate columns for first name and last name, this wouldn‚Äôt be necessary but the code would still work (unless your recipient has a space in their first name).</p><p><code>CONCATENATE()</code> allows to merge that first name we created from the full name column with the rest of our title template.</p><p>Similar thing in <strong>Column E</strong> with a twist: it would be a bit boring to have our entire on a single line, so <code>CHAR(10)</code> allows us to introduce line separators! <code>=CONCATENATE("Hi ", INDEX(SPLIT(A2, " "), 1), ", how are you?", CHAR(10), CHAR(10), "I just wanted to introduce you to my new project: X", CHAR(10), CHAR(10), "Cheers,", CHAR(10), "Damien")</code></p><p>Replace columns D &amp; E with the real text you wish to send.</p><h2 id="drafting-emails">Drafting Emails</h2><p>You can read more about setting up a Google Apps Script project from a spreadsheet in the ‚ÄúHow to Access Google Apps Scripts?‚Äù section of my previous article <a href="/blog/pull-facebook-ads-google-spreadsheet">How to Automatically Pull Facebook Ads Data in Google Spreadsheet?</a>.</p><p>In the <strong>Tools &gt; Script Editor</strong> section, copy &amp; paste:</p><div class="sourceCode" id="cb1"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">run</span>() {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> sheet <span class="op">=</span> SpreadsheetApp<span class="op">.</span><span class="fu">getActiveSheet</span>()<span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> data <span class="op">=</span> sheet<span class="op">.</span><span class="fu">getRange</span>(<span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> sheet<span class="op">.</span><span class="fu">getLastRow</span>()<span class="op">-</span><span class="dv">1</span><span class="op">,</span> sheet<span class="op">.</span><span class="fu">getLastColumn</span>())<span class="op">.</span><span class="fu">getValues</span>()<span class="op">;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  data<span class="op">.</span><span class="fu">forEach</span>(<span class="kw">function</span>(row) {</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> email <span class="op">=</span> row[<span class="dv">2</span>]<span class="op">;</span> <span class="co">// Third column</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> title <span class="op">=</span> row[<span class="dv">3</span>]<span class="op">;</span> <span class="co">// Forth column</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> content <span class="op">=</span> row[<span class="dv">4</span>]<span class="op">;</span> <span class="co">// Fifth column</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    GmailApp<span class="op">.</span><span class="fu">createDraft</span>(email<span class="op">,</span> title<span class="op">,</span> content)<span class="op">;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><p>Some explanation around <code>sheet.getRange(2, 1, sheet.getLastRow()-1, sheet.getLastColumn())</code>:</p><p><code>getRange()</code> returns the range of values starting from the first row, first column, number of rows and number of columns we provide.</p><ul><li><code>2</code> means the range starts at the 2nd row as the first one is just the column names.</li><li><code>1</code> means the range starts at the 1st column.</li><li><code>sheet.getLastRow()</code> counts how many rows are in the sheet. We subtract <code>1</code> to account for the first row of column names.</li><li><code>sheet.getLastColumn()</code> counts how many columns are in the sheet.</li></ul><p>Result is an array of array. To loop over this array, we can use <code>.forEach()</code> which will run the provided function to each row in the data range.</p><p>Arrays are 0-indexed in JavaScript so the first element of an array is accessible by <code>array[0]</code>. I added comments for clarity.</p><p><code>GmailApp.createDraft()</code> creates an email draft in the Gmail account you‚Äôre currently using when running the script.</p><p>Let‚Äôs run it by selecting the run function and clicking on the Run button ‚ñ∂Ô∏è directly from the script editor.</p><p>Be warned that you‚Äôll probably be prompted to authorize your own script to read and send emails from your account.</p><p>Head over to the <a href="https://mail.google.com/mail/u/0/#drafts">drafts section of your Gmail account</a>:</p><figure><img src="/images/gmail_drafts.png" alt="Gmail Drafts"><figcaption aria-hidden="true">Gmail Drafts</figcaption></figure><p>Congrats! You‚Äôve automatically generated email drafts.</p><h2 id="sending-emails">Sending Emails</h2><p>That‚Äôs actually the easy part!</p><p>You could send them manually from the Gmail interface but that‚Äôs not very fun‚Ä¶</p><p>To automatically send them via our script, simply add <code>.send()</code> after the draft creation in the code:</p><p><code>GmailApp.createDraft(email, title, content).send();</code></p><p><strong>Final code:</strong></p><div class="sourceCode" id="cb2"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">run</span>() {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> sheet <span class="op">=</span> SpreadsheetApp<span class="op">.</span><span class="fu">getActiveSheet</span>()<span class="op">;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> data <span class="op">=</span> sheet<span class="op">.</span><span class="fu">getRange</span>(<span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> sheet<span class="op">.</span><span class="fu">getLastRow</span>()<span class="op">-</span><span class="dv">1</span><span class="op">,</span> sheet<span class="op">.</span><span class="fu">getLastColumn</span>())<span class="op">.</span><span class="fu">getValues</span>()<span class="op">;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  data<span class="op">.</span><span class="fu">forEach</span>(<span class="kw">function</span>(row) {</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> email <span class="op">=</span> row[<span class="dv">2</span>]<span class="op">;</span> <span class="co">// Third column</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> title <span class="op">=</span> row[<span class="dv">3</span>]<span class="op">;</span> <span class="co">// Forth column</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> content <span class="op">=</span> row[<span class="dv">4</span>]<span class="op">;</span> <span class="co">// Fifth column</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    GmailApp<span class="op">.</span><span class="fu">createDraft</span>(email<span class="op">,</span> title<span class="op">,</span> content)<span class="op">.</span><span class="fu">send</span>()<span class="op">;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><h2 id="conclusion">Conclusion</h2><p>I hope you‚Äôve enjoyed this small Google Spreadsheet hack, possible with only 10 lines of code! There are many cool things you could do with this, but please don‚Äôt abuse it üôè.</p><p>Do not hesitate to <a href="/about">contact me</a> with any questions about the article.</p></div><script src="/highlight.js"></script><script>hljs.highlightAll();</script></body></html>
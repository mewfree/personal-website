<!doctype html><html lang="en"><head><title>How to Automatically Pull Facebook Ads Data in Google Spreadsheet? - Damien Gonot</title><link rel="stylesheet" href="/main.css"><link rel="stylesheet" href="/katex.min.css"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Introduction

We all know how much marketers love spreadsheets. They‚Äôre versatile,
allow for quick analyses and no coding is required.

They‚Äôre also often used as internal dashboards to measure and track the
performance of ads.

But did you know it was possible to use JavaScript to run scripts in..."><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body class="bg-white dark:bg-black"><header class="bg-indigo-600 dark:bg-black text-center text-white p-8"><div class="text-4xl font-bold mb-4">Damien Gonot</div><div class="text-xl flex space-x-8 justify-center"><a href="/" class="hover:underline">Home</a> <a href="/blog" class="hover:underline">Blog</a> <a href="/notes" class="hover:underline">Notes</a> <a href="/about" class="hover:underline">About</a> <a id="theme" class="text-2xl hover:cursor-pointer hover:dark" onclick="toggleTheme()">üåù</a></div><script>function loadCss(e){let t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href",`/highlight.${e}.css`),document.getElementsByTagName("head")[0].appendChild(t)}function toggleTheme(){"dark"===localStorage.theme||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(document.documentElement.classList.remove("dark"),document.getElementById("theme").innerText="üåù",loadCss(localStorage.theme="light")):(document.documentElement.classList.add("dark"),document.getElementById("theme").innerText="üåûÔ∏è",loadCss(localStorage.theme="dark"))}"dark"===localStorage.theme||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(document.documentElement.classList.add("dark"),document.getElementById("theme").innerText="üåûÔ∏è",loadCss("dark")):(document.documentElement.classList.remove("dark"),document.getElementById("theme").innerText="üåù",loadCss("light"))</script><script src="/highlight.js"></script><script defer="defer" src="/katex.min.js"></script><script defer="defer" src="/katex-auto-render.min.js"></script><script>document.addEventListener("DOMContentLoaded",e=>{document.querySelectorAll("pre code").forEach(e=>{e.classList.remove("sourceCode"),0<e.classList.length&&e.classList.replace(e.classList[0],"language-"+e.classList[0]),hljs.highlightElement(e)}),renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script></header><div class="prose prose-indigo dark:prose-invert dark:prose-a:text-indigo-400 max-w-3xl mx-auto p-8"><h1 class="text-center">How to Automatically Pull Facebook Ads Data in Google Spreadsheet?</h1><div class="text-center">written on 2020-02-02</div><h2 id="introduction">Introduction</h2><p>We all know how much marketers love spreadsheets. They‚Äôre versatile, allow for quick analyses and no coding is required.</p><p>They‚Äôre also often used as internal dashboards to measure and track the performance of ads.</p><p>But did you know it was possible to use JavaScript to run scripts inside Google Spreadsheets? A little known feature even allows us to write our own custom spreadsheet functions that can be used in any cell of any sheet.</p><p>This is the feature from Google Apps Scripts we‚Äôre going to use to automatically pull Facebook Ads data directly in our spreadsheets.</p><h2 id="how-to-access-google-apps-scripts">How to Access Google Apps Scripts?</h2><p>First, let‚Äôs create a fresh Google Spreadsheet using the handy <a href="https://sheet.new">sheet.new</a> URL, or navigate to your day-to-day marketing dashboard.</p><p>You should see an empty Google Spreadsheet, as below.</p><figure><img src="/images/empty_sheet.png" alt="Empty Sheet"><figcaption aria-hidden="true">Empty Sheet</figcaption></figure><p>Next, click on: <strong>Extensions &gt; Apps Script</strong></p><figure><img src="/images/script_editor_menu.png" alt="Script Editor Menu"><figcaption aria-hidden="true">Script Editor Menu</figcaption></figure><p>A new browser window should have opened showing Google Apps Script‚Äôs IDE (code editor) with an empty <code>myFunction</code>.</p><figure><img src="/images/empty_script.png" alt="Empty Script"><figcaption aria-hidden="true">Empty Script</figcaption></figure><p><del>Note that Google Apps Scripts does not support ES6 but older versions of JavaScript only.</del></p><p>Edit: With Google‚Äôs introduction of the V8 runtime for Google Apps Scripts, it is <a href="https://developers.google.com/apps-script/guides/v8-runtime#modern_ecmascript_syntax">now possible to use modern ECMAScript syntax</a>.</p><h2 id="discovering-google-apps-script">Discovering Google Apps Script</h2><h3 id="hello-world-in-google-apps-script">Hello, World! in Google Apps Script</h3><p>Let‚Äôs do a quick ‚ÄúHello, World!‚Äù in Google Apps Script.</p><p>One of the main differences from vanilla JavaScript is that logging isn‚Äôt done by <code>console.log()</code> but <code>Logger.log()</code> instead.</p><p>Insert <code>Logger.log('Hello, World');</code> in the ‚Äúbase‚Äù function:</p><div class="sourceCode" id="cb1"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">myFunction</span>() {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  Logger<span class="op">.</span><span class="fu">log</span>(<span class="st">&#39;Hello, World!&#39;</span>)<span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><p>Hit save üíæ or use the Ctrl/Cmd + S shortcut.</p><p>Next, run the script ‚ñ∂Ô∏è.</p><p>Go to View &gt; Logs or use the Ctrl/Cmd + Enter shortcut to open the Logs window.</p><p>Congrats, you‚Äôve run your first Google Apps Script! <img src="/images/logs_hello_world_700.png" alt="Logs Hello World"></p><h3 id="custom-function-basic-example">Custom Function Basic Example</h3><p>Let‚Äôs do a very simple custom function to show how it‚Äôs possible to create our own personal functions in Google Spreadsheet.</p><p>Replace the code in the Google Apps Script code editor to be:</p><div class="sourceCode" id="cb2"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">double</span>(number) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> number <span class="op">*</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><p>The goal of the function is to return the double of the number used as input.</p><p>Hit save üíæ and try your new spreadsheet function: <img src="/images/double_example.gif" alt="Double Example"></p><p>Congrats, you‚Äôve just augmented your Spreadsheet with the power of JavaScript!</p><h3 id="how-to-make-https-request">How to make HTTP(S) request</h3><p>Now let‚Äôs get to serious business: making external API calls.</p><p>We‚Äôll be using <a href="https://developers.google.com/apps-script/reference/url-fetch/url-fetch-app">UrlFetchApp</a> from Google Apps Script.</p><p>The most basic example of an HTTP request using <code>UrlFetchApp</code> in Google Apps Script is:</p><div class="sourceCode" id="cb3"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">FBInsights</span>() {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> response <span class="op">=</span> UrlFetchApp<span class="op">.</span><span class="fu">fetch</span>(<span class="st">&#39;https://example.com&#39;</span>)<span class="op">;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  Logger<span class="op">.</span><span class="fu">log</span>(response<span class="op">.</span><span class="fu">getContentText</span>())<span class="op">;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><p>Hit save üíæ and you should see an authorization as it‚Äôs the first time we‚Äôre running a script capable of querying external data.</p><p>Click on <strong>Review Permissions</strong> when the window prompts you.</p><p><img src="/images/unsafe_app_600.png" alt="Unsafe App"> Click on <strong>Advanced</strong> and then <strong>Go to {project name} (unsafe)</strong> (it is safe since you‚Äôre the project creator).</p><p><img src="/images/this_will_allow_650.png" alt="This Will Allow"> Click on <strong>Allow</strong>.</p><p><img src="/images/logs_example.png" alt="Logs Example"> As you can see above, we‚Äôve got the full HTML response of a GET query to <code>example.com</code>.</p><p>Let‚Äôs do the real thing using Facebook Insights API.</p><h2 id="querying-facebook-insights-api">Querying Facebook Insights API</h2><h3 id="authenticating">Authenticating</h3><p>Facebook Marketing API needs a way to authenticate yourself so that you and only you can access your data.</p><p>You will need to get an access token. You can read my article <a href="/blog/getting-started-with-facebook-marketing-api">Getting Started with Facebook Marketing API</a> to learn how to get one.</p><p>Example of logging Facebook Insights data from yesterday:</p><div class="sourceCode" id="cb4"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">FBInsights</span>(entity_id) {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> access_token <span class="op">=</span> <span class="st">&#39;REPLACE_BY_YOUR_ACCESS_TOKEN&#39;</span><span class="op">;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> url <span class="op">=</span> <span class="st">&#39;https://graph.facebook.com/v5.0/&#39;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> entity_id</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="st">&#39;/insights&#39;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="st">&#39;?date_preset=yesterday&#39;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="st">&#39;&amp;access_token=&#39;</span> <span class="op">+</span> access_token</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> response <span class="op">=</span> UrlFetchApp<span class="op">.</span><span class="fu">fetch</span>(url)<span class="op">;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> json <span class="op">=</span> response<span class="op">.</span><span class="fu">getContentText</span>()<span class="op">;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> data <span class="op">=</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">parse</span>(json)<span class="op">;</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> data<span class="op">;</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">run</span>() {</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  Logger<span class="op">.</span><span class="fu">log</span>(<span class="fu">FBInsights</span>(<span class="st">&#39;act_XXXXXXXXXXXXXXXX&#39;</span>))<span class="op">;</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><p>Notice how since Facebook‚Äôs response is in JSON we are using <code>JSON.parse()</code> to parse the response.</p><p>Do not forget to replace the <code>access_token</code> by your own access token and to add your own Facebook account ID when <code>FBInsights()</code> is called inside <code>run()</code> (or any other entity ID, like a campaign ID or an ad set ID).</p><p>A <code>run()</code> function is needed to wrap the <code>FBInsights()</code> function to be able to run it with parameters. Do not forget to switch the function to be run by <code>run()</code> before clicking on ‚ñ∂Ô∏è. <img src="/images/change_function.png" alt="Change Function"></p><p>Open Logs and you should see data for your entity from yesterday. <img src="/images/yesterday_logs.png" alt="Yesterday Logs"></p><h3 id="query-with-custom-dates">Query With Custom Dates</h3><p>Let‚Äôs tweak our existing script in order to be able to use a custom date:</p><div class="sourceCode" id="cb5"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">FBInsights</span>(entity_id<span class="op">,</span> date) {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> access_token <span class="op">=</span> <span class="st">&#39;REPLACE_BY_YOUR_ACCESS_TOKEN&#39;</span><span class="op">;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> url <span class="op">=</span> <span class="st">&#39;https://graph.facebook.com/v5.0/&#39;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> entity_id</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="st">&#39;/insights&#39;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="st">&#39;?time_range=&#39;</span> <span class="op">+</span> <span class="pp">encodeURIComponent</span>(<span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>({<span class="st">&#39;since&#39;</span><span class="op">:</span> date<span class="op">,</span> <span class="st">&#39;until&#39;</span><span class="op">:</span> date}))</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="st">&#39;&amp;access_token=&#39;</span> <span class="op">+</span> access_token</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> response <span class="op">=</span> UrlFetchApp<span class="op">.</span><span class="fu">fetch</span>(url)<span class="op">;</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> json <span class="op">=</span> response<span class="op">.</span><span class="fu">getContentText</span>()<span class="op">;</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> data <span class="op">=</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">parse</span>(json)<span class="op">;</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> data<span class="op">;</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">run</span>() {</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  Logger<span class="op">.</span><span class="fu">log</span>(<span class="fu">FBInsights</span>(<span class="st">&#39;act_XXXXXXXXXXXXXXXX&#39;</span><span class="op">,</span> <span class="st">&#39;2020-01-20&#39;</span>))<span class="op">;</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><p>Facebooks Insights API uses an object in the format of <code>{'since': YYYY-MM-DD, 'until': YYYY-MM-DD}</code> for the <code>time_range</code> parameter. <code>JSON.stringify()</code> is used to transfrom a native JS object to JSON, which we then wrap around using <code>encodeURIComponent()</code>.</p><p>By using the same date in <code>since</code> and <code>until</code> we‚Äôre getting the results for that one day.</p><h3 id="select-field">Select Field</h3><div class="sourceCode" id="cb6"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">FBInsights</span>(entity_id<span class="op">,</span> date<span class="op">,</span> field) {</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> access_token <span class="op">=</span> <span class="st">&#39;REPLACE_BY_YOUR_ACCESS_TOKEN&#39;</span><span class="op">;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> url <span class="op">=</span> <span class="st">&#39;https://graph.facebook.com/v5.0/&#39;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> entity_id</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="st">&#39;/insights&#39;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="st">&#39;?time_range=&#39;</span> <span class="op">+</span> <span class="pp">encodeURIComponent</span>(<span class="bu">JSON</span><span class="op">.</span><span class="fu">stringify</span>({<span class="st">&#39;since&#39;</span><span class="op">:</span> date<span class="op">,</span> <span class="st">&#39;until&#39;</span><span class="op">:</span> date}))</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="st">&#39;&amp;fields=&#39;</span> <span class="op">+</span> field</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">+</span> <span class="st">&#39;&amp;access_token=&#39;</span> <span class="op">+</span> access_token</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> response <span class="op">=</span> UrlFetchApp<span class="op">.</span><span class="fu">fetch</span>(url)<span class="op">;</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> json <span class="op">=</span> response<span class="op">.</span><span class="fu">getContentText</span>()<span class="op">;</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> data <span class="op">=</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">parse</span>(json)<span class="op">;</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="pp">parseFloat</span>(data[<span class="st">&#39;data&#39;</span>][<span class="dv">0</span>][field])<span class="op">;</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">run</span>() {</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  Logger<span class="op">.</span><span class="fu">log</span>(<span class="fu">FBInsights</span>(<span class="st">&#39;act_XXXXXXXXXXXXXXXX&#39;</span><span class="op">,</span> <span class="st">&#39;2020-01-20&#39;</span><span class="op">,</span> <span class="st">&#39;spend&#39;</span>))<span class="op">;</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><p>This adds <code>field</code> as a function parameter, adds the necessary query parameter in the URL and tweaks the <code>return</code> statement to only return the data from that specific <code>field</code>, parsed as a float.</p><p>To know more about all possible fields, please refer to my <a href="/blog/guide-facebook-insights-api">Guide to Facebook Insights API</a>.</p><h2 id="final-demo">Final demo</h2><p>You can now use <code>=FBInsights("entity_id", TEXT("date", "yyyy-mm-dd"), "field_name")</code> in your Spreadsheets! <code>=TEXT()</code> is useful to convert any date into the <code>YYYY-MM-DD</code> format required by Facebook.</p><p>Here is an example to retrieve spend for dates in column A. Formula I‚Äôm using in the example below: <code>=FBInsights("REPLACE_BY_YOUR_ENTITY_ID", TEXT(A2, "yyyy-mm-dd"), "spend")</code></p><figure><img src="/images/spend_by_date.gif" alt="Spend by Date"><figcaption aria-hidden="true">Spend by Date</figcaption></figure><p>Now try it yourself with different fields (clicks, impressions‚Ä¶)!</p><p>PS: For the purpose of this article I added <code>* Math.random()</code> in my return statement to multiply my spend numbers by a random number in order to obfuscate what my real spend data is.</p><h2 id="conclusion">Conclusion</h2><p>Not only have you learnt how to create your own personal Google Spreadsheet function, but you‚Äôve also learnt how to query Facebook‚Äôs Marketing API &amp; Insights API. Combining the two allows you to query your Facebook Ads data directly from Google Spreadsheet.</p><p>If you would like to do something similar with Google Ads data, please go read <a href="/blog/adwords-google-spreadsheets">Connecting Google Ads Scripts with Google Spreadsheets</a>.</p><p>Do not hesitate to <a href="/about">contact me</a> with any questions about the article.</p></div></body></html>
<!doctype html><html lang="en"><head><title>Connecting Google Ads Scripts with Google Spreadsheets - Damien Gonot</title><link rel="stylesheet" href="/main.css"><link rel="stylesheet" href="/katex.min.css"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Today we‚Äôll learn one of the most powerful tools of Google Ads scripts:
being able to read/write data to and from Google Spreadsheets. It is
definitely one of my favourite features and I am really excited to share
this with you.

How to read Google Spreadsheets data from Google Ads scripts

Openi..."><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body class="bg-white dark:bg-black"><header class="bg-indigo-600 dark:bg-black text-center text-white p-8"><div class="text-4xl font-bold mb-4">Damien Gonot</div><div class="text-xl flex space-x-8 justify-center"><a href="/" class="hover:underline">Home</a> <a href="/blog" class="hover:underline">Blog</a> <a href="/notes" class="hover:underline">Notes</a> <a href="/about" class="hover:underline">About</a> <a id="theme" class="text-2xl hover:cursor-pointer hover:dark" onclick="toggleTheme()">üåù</a></div><script>function loadCss(e){let t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href",`/highlight.${e}.css`),document.getElementsByTagName("head")[0].appendChild(t)}function toggleTheme(){"dark"===localStorage.theme||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(document.documentElement.classList.remove("dark"),document.getElementById("theme").innerText="üåù",loadCss(localStorage.theme="light")):(document.documentElement.classList.add("dark"),document.getElementById("theme").innerText="üåûÔ∏è",loadCss(localStorage.theme="dark"))}"dark"===localStorage.theme||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(document.documentElement.classList.add("dark"),document.getElementById("theme").innerText="üåûÔ∏è",loadCss("dark")):(document.documentElement.classList.remove("dark"),document.getElementById("theme").innerText="üåù",loadCss("light"))</script><script src="/highlight.js"></script><script defer="defer" src="/katex.min.js"></script><script defer="defer" src="/katex-auto-render.min.js"></script><script>document.addEventListener("DOMContentLoaded",e=>{document.querySelectorAll("pre code").forEach(e=>{e.classList.remove("sourceCode"),0<e.classList.length&&e.classList.replace(e.classList[0],"language-"+e.classList[0]),hljs.highlightElement(e)}),renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script></header><div class="prose prose-indigo dark:prose-invert dark:prose-a:text-indigo-400 max-w-3xl mx-auto p-8"><h1 class="text-center">Connecting Google Ads Scripts with Google Spreadsheets</h1><div class="text-center">written on 2018-05-10</div><p>Today we‚Äôll learn one of the most powerful tools of Google Ads scripts: being able to read/write data to and from Google Spreadsheets. It is definitely one of my favourite features and I am really excited to share this with you.</p><h2 id="how-to-read-google-spreadsheets-data-from-google-ads-scripts">How to read Google Spreadsheets data from Google Ads scripts</h2><h3 id="opening-our-spreadsheet">Opening our spreadsheet</h3><p>The first step in reading Google Spreadsheets data is to choose which Spreadsheet we want to work from üôÇ. Hopefully, you already have a specific project/sheet in mind.</p><p>You can open a spreadsheet by either ID or URL: - <code>SpreadsheetApp.openByID();</code> - <code>SpreadsheetApp.openByUrl();</code></p><p>There are no differences between the two, but I have a small preference for the later as it feels simpler and more natural to me.</p><p>Let‚Äôs go ahead and do that. For the purpose of this tutorial I‚Äôll use this spreadsheet as an example: <a href="https://docs.google.com/spreadsheets/d/1ARKwW_kAf8rJJ9_XP4kl__kc56inghZdBtNrClfRlvc/edit">https://docs.google.com/spreadsheets/d/1ARKwW_kAf8rJJ9_XP4kl__kc56inghZdBtNrClfRlvc/edit</a>.</p><div class="sourceCode" id="cb1"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> spreadsheet <span class="op">=</span> SpreadsheetApp<span class="op">.</span><span class="fu">openByUrl</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;https://docs.google.com/spreadsheets/d/1ARKwW_kAf8rJJ9_XP4kl__kc56inghZdBtNrClfRlvc/edit&#39;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  Logger<span class="op">.</span><span class="fu">log</span>(spreadsheet<span class="op">.</span><span class="fu">getName</span>())<span class="op">;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><p>If you run or preview this in Google Ads scripts, you‚Äôll notice we have to give additional permissions so that the script is able to run: <img src="/images/scripts_permissions.png" alt="New permissions"></p><p>After this is done, you should be able to see your spreadsheet‚Äôs name in the logs. <img src="/images/spreadsheet_name_log.png" alt="Spreadsheet name log"></p><h3 id="selecting-a-sheet">Selecting a sheet</h3><p>Spreadsheets can hold multiples sheets. We can select a sheet either by its name (<code>spreadsheet.getSheetByName('sheet_name')</code>) or its position (<code>spreadsheet.getSheets()[0]</code> for the first sheet, <code>spreadsheet.getSheets()[1]</code> for the second sheet‚Ä¶).</p><p>I‚Äôll use <code>.getSheetByName()</code> so that my script still works even if I re-order the sheets.</p><div class="sourceCode" id="cb2"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> spreadsheet <span class="op">=</span> SpreadsheetApp<span class="op">.</span><span class="fu">openByUrl</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;https://docs.google.com/spreadsheets/d/1ARKwW_kAf8rJJ9_XP4kl__kc56inghZdBtNrClfRlvc/edit&#39;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  Logger<span class="op">.</span><span class="fu">log</span>(spreadsheet<span class="op">.</span><span class="fu">getName</span>())<span class="op">;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> sheet <span class="op">=</span> spreadsheet<span class="op">.</span><span class="fu">getSheetByName</span>(<span class="st">&#39;read&#39;</span>)<span class="op">;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  Logger<span class="op">.</span><span class="fu">log</span>(sheet<span class="op">.</span><span class="fu">getSheetName</span>())<span class="op">;</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><p>This should log <code>read</code> as it is the sheet we selected and are currently working on üëç.</p><h3 id="reading-values">Reading values</h3><p>Once again, we‚Äôre offered many possibilities here!</p><p>A pretty straightforward solution is to use <code>sheet.getSheetValues(startRow, startColumn, numRows, numColumns)</code>. Keep in mind sheets rows and columns index start at 1. A value of -1 means it is the last row or column with data. Therefore getting the values for an entire sheet would be done this way: <code>sheet.getSheetValues(1, 1, -1, -1)</code>.</p><p>Another solution is to use <code>.getRange()</code> followed by <code>.getValues()</code> for a grid selection, or <code>.getValue()</code> for a single cell (or the first cell of the range). This function has a flexible number of arguments: - <code>.getRange(a1Notation)</code>: uses the same notation you would use in a formula inside a spreadsheet, which may be the most natural for you. Examples: <code>sheet.getRange('A1').getValue()</code> gets you the content of the first (A1) cell, <code>sheet.getRange('A1:A5').getValues()</code> gets you the content of the first 5 rows of the first column, <code>sheet.getRange('A1:C10').getValues()</code> gets you the content of the <code>A1:C10</code> grid. - <code>.getRange(row, column)</code>: for a single cell. Example: <code>sheet.getRange(1, 1).getValue()</code> to get the value of the first cell (first column, first row) of the sheet. Corresponds to the A1 cell. - <code>.getRange(row, column, numRows)</code>: for a ‚Äúvertical‚Äù selection. Example: <code>sheet.getRange(2, 1, 4).getValues()</code> to get the values of the first column, starting from the second row, up until row 5. - <code>.getRange(row, column, numRows, numColumns)</code>: same principle as for <code>.getSheetValues</code>.</p><h3 id="real-life-example">Real-life example</h3><p>Remember my fake bike repair shops from the <a href="/blog/adwords-scripts-create-ads">Programmatically Create Ads</a> article?</p><p>I hardcoded the list of shops/cities inside the script but now we‚Äôd be able to read that data directly from a spreadsheet!</p><p>In my <a href="https://docs.google.com/spreadsheets/d/1ARKwW_kAf8rJJ9_XP4kl__kc56inghZdBtNrClfRlvc/edit">example spreadsheet</a>, I have data in A1:C6 with shop name in column A, the city name in column B and the population of the city in column C and with headers on the first row. Let‚Äôs read all of this:</p><div class="sourceCode" id="cb3"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> spreadsheet <span class="op">=</span> SpreadsheetApp<span class="op">.</span><span class="fu">openByUrl</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;https://docs.google.com/spreadsheets/d/1ARKwW_kAf8rJJ9_XP4kl__kc56inghZdBtNrClfRlvc/edit&#39;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> sheet <span class="op">=</span> spreadsheet<span class="op">.</span><span class="fu">getSheetByName</span>(<span class="st">&#39;read&#39;</span>)<span class="op">;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> data <span class="op">=</span> sheet<span class="op">.</span><span class="fu">getSheetValues</span>(<span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  Logger<span class="op">.</span><span class="fu">log</span>(data)<span class="op">;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><p>Result:</p><pre><code>[[NYCycle, New York City, 2.0320876E7], [Angel&#39;bikes, Los Angeles, 1.3131431E7], [Chicago Bike Shop, Chicago, 9512999.0], [Houston Cycle, Houston, 6313158.0], [Phillie Bikes, Philadelphia, 6096120.0]]</code></pre><p>As you can see we got an array of array back. Let‚Äôs iterate over the main array and assign values to make everything looks simpler:</p><div class="sourceCode" id="cb5"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> spreadsheet <span class="op">=</span> SpreadsheetApp<span class="op">.</span><span class="fu">openByUrl</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;https://docs.google.com/spreadsheets/d/1ARKwW_kAf8rJJ9_XP4kl__kc56inghZdBtNrClfRlvc/edit&#39;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> sheet <span class="op">=</span> spreadsheet<span class="op">.</span><span class="fu">getSheetByName</span>(<span class="st">&#39;read&#39;</span>)<span class="op">;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> data <span class="op">=</span> sheet<span class="op">.</span><span class="fu">getSheetValues</span>(<span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  data<span class="op">.</span><span class="fu">forEach</span>(<span class="kw">function</span>(row) {</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> city <span class="op">=</span> row[<span class="dv">1</span>]<span class="op">;</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    Logger<span class="op">.</span><span class="fu">log</span>(city)<span class="op">;</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><p>Result:</p><pre><code>New York City
Los Angeles
Chicago
Houston
Philadelphia</code></pre><p>Amazing! Now it would be possible to combine this script and the one from my <a href="/blog/adwords-scripts-create-ads">Programmatically Create Ads</a> article to automatically create ads based on spreadsheet data!</p><h2 id="how-to-write-data-from-google-ads-scripts-to-google-spreadsheets">How to write data from Google Ads scripts to Google Spreadsheets</h2><p>I‚Äôm going to re-use knowledge from <a href="/blog/adwords-scripts-reading-data">Google Ads Scripts: Reading Data</a> to read ad group data from a specific campaign and write it to our <a href="https://docs.google.com/spreadsheets/d/1ARKwW_kAf8rJJ9_XP4kl__kc56inghZdBtNrClfRlvc/edit">example spreadsheet</a>.</p><p>Let‚Äôs put all of that data in an array first. We can iterate over the array and push every ad group name and ID in the array. I initiated the data array with column headers.</p><div class="sourceCode" id="cb7"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> spreadsheet <span class="op">=</span> SpreadsheetApp<span class="op">.</span><span class="fu">openByUrl</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;https://docs.google.com/spreadsheets/d/1ARKwW_kAf8rJJ9_XP4kl__kc56inghZdBtNrClfRlvc/edit&#39;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> sheet <span class="op">=</span> spreadsheet<span class="op">.</span><span class="fu">getSheetByName</span>(<span class="st">&#39;write&#39;</span>)<span class="op">;</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> adGroups <span class="op">=</span> AdsApp</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">adGroups</span>()</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withCondition</span>(<span class="st">&#39;CampaignName = &quot;united_states-cities&quot;&#39;</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">get</span>()<span class="op">;</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> data <span class="op">=</span> [[<span class="st">&#39;ad group name&#39;</span><span class="op">,</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;yesterday impressions&#39;</span><span class="op">,</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;yesterday clicks&#39;</span><span class="op">,</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;yesterday avg CPC&#39;</span><span class="op">,</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;yesterday cost&#39;</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>              ]]<span class="op">;</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (adGroups<span class="op">.</span><span class="fu">hasNext</span>()) {</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> adGroup <span class="op">=</span> adGroups<span class="op">.</span><span class="fu">next</span>()<span class="op">;</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    data<span class="op">.</span><span class="fu">push</span>([</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>      adGroup<span class="op">.</span><span class="fu">getName</span>()<span class="op">,</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>      adGroup<span class="op">.</span><span class="fu">getStatsFor</span>(<span class="st">&#39;YESTERDAY&#39;</span>)<span class="op">.</span><span class="fu">getImpressions</span>()<span class="op">,</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>      adGroup<span class="op">.</span><span class="fu">getStatsFor</span>(<span class="st">&#39;YESTERDAY&#39;</span>)<span class="op">.</span><span class="fu">getClicks</span>()<span class="op">,</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>      adGroup<span class="op">.</span><span class="fu">getStatsFor</span>(<span class="st">&#39;YESTERDAY&#39;</span>)<span class="op">.</span><span class="fu">getAverageCpc</span>()<span class="op">,</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>      adGroup<span class="op">.</span><span class="fu">getStatsFor</span>(<span class="st">&#39;YESTERDAY&#39;</span>)<span class="op">.</span><span class="fu">getCost</span>()</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    ])<span class="op">;</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  Logger<span class="op">.</span><span class="fu">log</span>(data)<span class="op">;</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><p><code>.getStatsFor(date_range)</code> is a useful method to get statistical data for a specific date range. Other date ranges like <code>LAST_7_DAYS</code> or <code>LAST_MONTH</code> can be used.</p><p>Result:</p><pre><code>[[ad group name, yesterday impressions, yesterday clicks, yesterday avg CPC, yesterday cost], [philadelphia, 0, 0, 0.0, 0.0], [chicago, 0, 0, 0.0, 0.0], [los_angeles, 0, 0, 0.0, 0.0], [houston, 0, 0, 0.0, 0.0], [new_york_city, 0, 0, 0.0, 0.0]]</code></pre><p>This is from a paused campaign so every stat is at 0 but you should see your real-life numbers. Our data is now well structured. The last step is to write the data in the sheet by adding <code>.setValues()</code> at the end.</p><h3 id="final-script">Final script</h3><div class="sourceCode" id="cb9"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> spreadsheet <span class="op">=</span> SpreadsheetApp<span class="op">.</span><span class="fu">openByUrl</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;https://docs.google.com/spreadsheets/d/1ARKwW_kAf8rJJ9_XP4kl__kc56inghZdBtNrClfRlvc/edit&#39;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> sheet <span class="op">=</span> spreadsheet<span class="op">.</span><span class="fu">getSheetByName</span>(<span class="st">&#39;write&#39;</span>)<span class="op">;</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> adGroups <span class="op">=</span> AdsApp</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">adGroups</span>()</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">withCondition</span>(<span class="st">&#39;CampaignName = &quot;united_states-cities&quot;&#39;</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">get</span>()<span class="op">;</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> data <span class="op">=</span> [[<span class="st">&#39;ad group name&#39;</span><span class="op">,</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;yesterday impressions&#39;</span><span class="op">,</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;yesterday clicks&#39;</span><span class="op">,</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;yesterday avg CPC&#39;</span><span class="op">,</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>               <span class="st">&#39;yesterday cost&#39;</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>              ]]<span class="op">;</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (adGroups<span class="op">.</span><span class="fu">hasNext</span>()) {</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> adGroup <span class="op">=</span> adGroups<span class="op">.</span><span class="fu">next</span>()<span class="op">;</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    data<span class="op">.</span><span class="fu">push</span>([</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>      adGroup<span class="op">.</span><span class="fu">getName</span>()<span class="op">,</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>      adGroup<span class="op">.</span><span class="fu">getStatsFor</span>(<span class="st">&#39;YESTERDAY&#39;</span>)<span class="op">.</span><span class="fu">getImpressions</span>()<span class="op">,</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>      adGroup<span class="op">.</span><span class="fu">getStatsFor</span>(<span class="st">&#39;YESTERDAY&#39;</span>)<span class="op">.</span><span class="fu">getClicks</span>()<span class="op">,</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>      adGroup<span class="op">.</span><span class="fu">getStatsFor</span>(<span class="st">&#39;YESTERDAY&#39;</span>)<span class="op">.</span><span class="fu">getAverageCpc</span>()<span class="op">,</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>      adGroup<span class="op">.</span><span class="fu">getStatsFor</span>(<span class="st">&#39;YESTERDAY&#39;</span>)<span class="op">.</span><span class="fu">getCost</span>()</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>    ])<span class="op">;</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>  Logger<span class="op">.</span><span class="fu">log</span>(data)<span class="op">;</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>  sheet</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">getRange</span>(<span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> data<span class="op">.</span><span class="at">length</span><span class="op">,</span> data[<span class="dv">0</span>]<span class="op">.</span><span class="at">length</span>)</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">setValues</span>(data)<span class="op">;</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><p>I‚Äôm using the length of the array and the length of the first element of the array to automatically know which range to select as the data ‚Äúgrid‚Äù and the range has to be of the exact same size.</p><p>Just a warning that previewing the script will actually write the data in the spreadsheet! So be careful.</p><h3 id="spreadsheet-result">Spreadsheet Result</h3><figure><img src="/images/write_sheet_result.png" alt="write sheet result"><figcaption aria-hidden="true">write sheet result</figcaption></figure><p>This is really useful if you‚Äôre interested in having your own custom dashboard right in Google Spreadsheets. If you want to have this data updated automatically every day, I would suggest turning on daily updates through Google Ads scripts‚Äô frequency feature available on the Google Ads scripts homepage: <img src="/images/daily_frequency.png" alt="daily frequency"></p><p><strong>Your spreadsheet will now be updated every day at your desired time with your campaigns/ad groups data!</strong></p><p><strong>Thank you for reading and feel free to contact me for any suggestions or remarks.</strong></p></div></body></html>
<!doctype html><html lang="en"><head><title>Google Ads Scripts: Modify Entities - Damien Gonot</title><link rel="stylesheet" href="/main.css"><link rel="stylesheet" href="/katex.min.css"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="How to modify entities from Google Ads scripts?

In the Google Ads Scripts: Reading Data, we saw how to read data in
Google Ads Script. Now we‚Äôll see how to take actions and modify ad
entities (ad groups, keywords, ads‚Ä¶). For example, this would allow us
to automate the recurring optimization we ..."><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></head><body class="bg-white dark:bg-black"><header class="bg-indigo-600 dark:bg-black text-center text-white p-8"><div class="text-4xl font-bold mb-4">Damien Gonot</div><div class="text-xl flex space-x-8 justify-center"><a href="/" class="hover:underline">Home</a> <a href="/blog" class="hover:underline">Blog</a> <a href="/university" class="hover:underline">University</a> <a href="/about" class="hover:underline">About</a> <a id="theme" class="text-2xl hover:cursor-pointer hover:dark" onclick="toggleTheme()">üåù</a></div><script>function loadCss(e){let t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("href",`/highlight.${e}.css`),document.getElementsByTagName("head")[0].appendChild(t)}function toggleTheme(){"dark"===localStorage.theme||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(document.documentElement.classList.remove("dark"),document.getElementById("theme").innerText="üåù",loadCss(localStorage.theme="light")):(document.documentElement.classList.add("dark"),document.getElementById("theme").innerText="üåûÔ∏è",loadCss(localStorage.theme="dark"))}"dark"===localStorage.theme||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches?(document.documentElement.classList.add("dark"),document.getElementById("theme").innerText="üåûÔ∏è",loadCss("dark")):(document.documentElement.classList.remove("dark"),document.getElementById("theme").innerText="üåù",loadCss("light"))</script><script src="/highlight.js"></script><script>hljs.highlightAll()</script><script defer="defer" src="/katex.min.js"></script><script defer="defer" src="/katex-auto-render.min.js"></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script></header><div class="prose prose-indigo dark:prose-invert dark:prose-a:text-indigo-400 max-w-3xl mx-auto p-8"><h1 class="text-center">Google Ads Scripts: Modify Entities</h1><div class="text-center">written on 2018-03-31</div><h2 id="how-to-modify-entities-from-google-ads-scripts">How to modify entities from Google Ads scripts?</h2><p>In the <a href="/blog/adwords-scripts-reading-data">Google Ads Scripts: Reading Data</a>, we saw how to read data in Google Ads Script. Now we‚Äôll see how to take actions and modify ad entities (ad groups, keywords, ads‚Ä¶). For example, this would allow us to automate the recurring optimization we might be doing every day, every week or every month.</p><p>Here are a few examples: - Read over all the keywords and lower Cost Per Clicks (CPCs) for the keywords that have a Cost Per Action (CPA) over a certain threshold. - Update the copy of all ads that match a certain template. - etc..</p><p>We are going to implement a slightly different version of the first example.</p><h2 id="raising-bids-on-specific-keywords">Raising bids on specific keywords</h2><p>Imagine we have big pockets and want to stay in position 2 or better at all times for all keywords. First, we‚Äôll need to find all keywords with an average position (avg. pos.) worse than 2. This should be easy to do thanks to what we‚Äôve learnt in the <a href="/blog/adwords-scripts-reading-data">previous tutorial</a>. Then, we‚Äôll raise the bids on those keywords by an arbitrary amount (+10%) in order to try to raise the avg. pos. to 2 or better.</p><h3 id="fetching-keywords-with-a-specific-average-position">Fetching keywords with a specific average position</h3><p>In order to combine the <code>.withCondition()</code> method with a statistic (like <code>Average Position</code>) we have to precise a date range with <code>.forDateRange()</code>. Google Ads provide a few ready-to-use ranges such as <code>YESTERDAY</code>, <code>LAST_7_DAYS</code>, <code>LAST_30_DAYS</code>‚Ä¶ The complete list of ranges can be found <a href="https://developers.google.com/adwords/scripts/docs/reference/adwordsapp/adwordsapp_keywordselector#forDateRange_2">here</a>. A custom <code>dateFrom</code> and <code>dateTo</code> at the <code>YYYYMMDD</code> format can also be used (example: <code>.forDateRange('20180401', '20180410')</code> for the first 10 days of April 2018). We‚Äôll use <code>LAST_7_DAYS</code> this time.</p><div class="sourceCode" id="cb1"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">fetchingKeywords</span>() {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> keywords <span class="op">=</span> AdsApp</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">keywords</span>()</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">withCondition</span>(<span class="st">&#39;AveragePosition &gt; 2&#39;</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">forDateRange</span>(<span class="st">&#39;LAST_7_DAYS&#39;</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">get</span>()<span class="op">;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><p>In order to test the <code>.withCondition()</code> method is working, we can read the avg. pos. of the result using <code>keyword.getStatsFor('LAST_7_DAYS').getAveragePosition()</code>. Obviously, same date range has to be used or results would differ.</p><div class="sourceCode" id="cb2"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">fetchingKeywords</span>() {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> keywords <span class="op">=</span> AdsApp</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">keywords</span>()</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">withCondition</span>(<span class="st">&#39;AveragePosition &gt; 2&#39;</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">forDateRange</span>(<span class="st">&#39;LAST_7_DAYS&#39;</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">get</span>()<span class="op">;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (keywords<span class="op">.</span><span class="fu">hasNext</span>()) {</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> keyword <span class="op">=</span> keywords<span class="op">.</span><span class="fu">next</span>()<span class="op">;</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    Logger<span class="op">.</span><span class="fu">log</span>(keyword<span class="op">.</span><span class="fu">getText</span>())<span class="op">;</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    Logger<span class="op">.</span><span class="fu">log</span>(keyword<span class="op">.</span><span class="fu">getStatsFor</span>(<span class="st">&#39;LAST_7_DAYS&#39;</span>)<span class="op">.</span><span class="fu">getAveragePosition</span>())<span class="op">;</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fetchingKeywords</span>()<span class="op">;</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><p>Now, I commented out the <code>keyword.getText()</code> log in order to protect the private information of the client I was trying this script on, but we can see that all the keywords have indeed an avg. pos. of 2 or worse: <img src="/images/keywords_avg_pos.png" alt="keywords_avg_pos"></p><h3 id="raising-max-cpcs-on-keywords">Raising max CPCs on keywords</h3><p>Let‚Äôs take care of the bids now! It‚Äôs pretty straightforward to do so by using <code>.bidding().setCpc()</code> on the <code>keyword</code> entity, but first, we need to get the current max CPC to calculate the new bid (remember we want to raise the bids by 10%). This is done by using <code>.bidding().getCpc()</code>. With all this knowledge, final formula is very simple:</p><div class="sourceCode" id="cb3"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> new_bid <span class="op">=</span> keyword<span class="op">.</span><span class="fu">bidding</span>()<span class="op">.</span><span class="fu">getCpc</span>() <span class="op">*</span> <span class="fl">1.1</span><span class="op">;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  keyword<span class="op">.</span><span class="fu">bidding</span>()<span class="op">.</span><span class="fu">setCpc</span>(new_bid)<span class="op">;</span></span></code></pre></div><p>This could have fit on one line but putting the calculated bid in its own variable allows for more readability.</p><p>I also changed the name of our function as it now not only fetches the keywords but also changes the bids.</p><div class="sourceCode" id="cb4"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">raiseBidsKeywords</span>() {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> keywords <span class="op">=</span> AdsApp</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">keywords</span>()</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">withCondition</span>(<span class="st">&#39;AveragePosition &gt; 2&#39;</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">forDateRange</span>(<span class="st">&#39;LAST_7_DAYS&#39;</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>      <span class="op">.</span><span class="fu">get</span>()<span class="op">;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (keywords<span class="op">.</span><span class="fu">hasNext</span>()) {</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> keyword <span class="op">=</span> keywords<span class="op">.</span><span class="fu">next</span>()<span class="op">;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> new_bid <span class="op">=</span> keyword<span class="op">.</span><span class="fu">bidding</span>()<span class="op">.</span><span class="fu">getCpc</span>() <span class="op">*</span> <span class="fl">1.1</span><span class="op">;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    keyword<span class="op">.</span><span class="fu">bidding</span>()<span class="op">.</span><span class="fu">setCpc</span>(new_bid)<span class="op">;</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">main</span>() {</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">raiseBidsKeywords</span>()<span class="op">;</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><p>Now, if you press the preview button, for the first time you‚Äôll see some stuff appear in the <strong>Changes</strong> section! Don‚Äôt worry, changes haven‚Äôt been made yet, Google Ads is only showing you what the changes would be if you actually run the script. <img src="/images/keywords_change.png" alt="keywords_change"></p><p>The last step is to press on <strong>Run</strong> instead of Preview. Be careful, this will change max CPCs in your real account.</p><p><strong>Congrats, your Google Ads Script made changes on your behalf!</strong></p><p>Now that we‚Äôre happy with our script since it looks back on the past 7 days data, wouldn‚Äôt it be nice if it ran on a weekly basis? On the Google Ads scripts list, you can set the frequency to weekly and choose the day of the week and time that suits you: <img src="/images/frequency_change.png" alt="frequency_change"></p></div></body></html>